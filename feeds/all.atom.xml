<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Indexed Column</title><link href="https://victal.eti.br/" rel="alternate"></link><link href="https://victal.eti.br/feeds/all.atom.xml" rel="self"></link><id>https://victal.eti.br/</id><updated>2020-01-31T00:00:00-03:00</updated><subtitle>"No wonder it's so slow to update"</subtitle><entry><title>Customizing an existing Keyboard Layout on Windows</title><link href="https://victal.eti.br/customizing-an-existing-keyboard-layout-on-windows.html" rel="alternate"></link><published>2020-01-31T00:00:00-03:00</published><updated>2020-01-31T00:00:00-03:00</updated><author><name>victal</name></author><id>tag:victal.eti.br,2020-01-31:/customizing-an-existing-keyboard-layout-on-windows.html</id><summary type="html">&lt;p&gt;For one reason or another&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt;, I've started trying to learn Swedish in my spare time, as one does. 
Although it is at times quite similar to English, the peculiarities of Swedish start to show up right at its alphabet - there are &lt;strong&gt;9 vowels&lt;/strong&gt; in &lt;em&gt;Svenska&lt;/em&gt;, as opposed to the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;For one reason or another&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt;, I've started trying to learn Swedish in my spare time, as one does. 
Although it is at times quite similar to English, the peculiarities of Swedish start to show up right at its alphabet - there are &lt;strong&gt;9 vowels&lt;/strong&gt; in &lt;em&gt;Svenska&lt;/em&gt;, as opposed to the five that english (or any latin-derived language) speakers are used to. &lt;/p&gt;
&lt;p&gt;Now, what does that have to do with Windows keyboard layouts?&lt;/p&gt;
&lt;p&gt;Well, it turns out that one of those 9 aforementioned vowels is &lt;strong&gt;å&lt;/strong&gt; - a character that has no simple input on both keyboard layouts I use (US and Brazil ABNT2). And since I only needed two extra characters (for uppercase Å/lowercase å), I definitely couldn't be bothered with checking out whatever the common keyboard layout for swedish might be, even though it does not seem possible, from Windows configuration options alone, to customize a given keyboard layout to add a character or two as a given keypress combination.&lt;/p&gt;
&lt;p&gt;Thankfully, though, I stumbled on a tweet&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2"&gt;2&lt;/a&gt;&lt;/sup&gt; that mentioned an actual Microsoft tool that lets one do just that!
One can get the aptly-named Microsoft Keyboard Layout Creator (MSKLC for short from here on) from &lt;a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=22339"&gt;https://www.microsoft.com/en-us/download/confirmation.aspx?id=22339&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;After downloading the installer (MSKLC.exe) and installing the tool (open the installer, click on setup and then follow the usual Next -&amp;gt; Next -&amp;gt; Next -&amp;gt; Finish installation ritual), one can find and open the Keyboard Layout Creator from the Start Menu, and then we can get started creating our customized Swenglish Keyboard Layout:&lt;/p&gt;
&lt;h2&gt;1 - Customizing the Layout&lt;/h2&gt;
&lt;p&gt;Upon starting the Layout Creator, it opens an empty layout to work with. Since we only want to change a couple keys, we can load an existing keyboard layout to speed things up, and go from there:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Loading an existing layout" src="static/msklc/1_load_existing_keyboard_1.png" title="Menu for loading an existing layout"&gt;&lt;/p&gt;
&lt;p&gt;(An Keyboard editor it does not have keyboard shortcuts for every action? I want my money back)&lt;/p&gt;
&lt;p&gt;&lt;img alt="Selecting an existing layout to load" src="static/msklc/2_load_existing_keyboard_2.png" title="Selecting an existing layout to load"&gt;&lt;/p&gt;
&lt;p&gt;For this example, we'll be using the 'US' keyboard as the initial layout.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Existing layout loaded" src="static/msklc/3_load_existing_keyboard_3.png" title="Existing layout loaded"&gt;&lt;/p&gt;
&lt;p&gt;Et voilà!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Now, using this tool is quite straightforward: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use the toggles on the left side to show the keyboard state with Shift/Ctrl/AltGr pressed. For this example, we'll bind &lt;strong&gt;å&lt;/strong&gt; to &lt;strong&gt;AltGr + a&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Layout with selected shift state" src="static/msklc/4_layout_altgr.png" title="Layout with selected shift state"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Click on the key to which you want to assign a given character.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Selected key popup" src="static/msklc/5_selected_key_popup.png" title="Selected key popup"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Copy the desired character to the textbox on the popup (from a text with the desired character on it, or using the ubiquitous &lt;a href="https://en.wikipedia.org/wiki/Character_Map_(Windows)"&gt;Character Map&lt;/a&gt;) and click OK.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Saved new character" src="static/msklc/6_saved_character.png" title="Saved new character"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;All done!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Adding Å as AltGr+Shift+a is just as simple - we just need to toggle both the AltGr and Shift states and remember to add the uppercase letter:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Adding uppercase letter" src="static/msklc/7_adding_uppercase_letter.png" title="Adding uppercase letter"&gt;&lt;/p&gt;
&lt;h2&gt;2 - Naming, saving, and installing the layout&lt;/h2&gt;
&lt;p&gt;After customizing the keyboard layout to our hearts' contents, we'll need to save an installer in order to add it to a computer.&lt;/p&gt;
&lt;p&gt;To do so, simply choose the menu option &lt;strong&gt;Project -&amp;gt; Build DLL and Setup Package&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Build Package menu" src="static/msklc/8_build_dll_menu.png" title="Build Package menu"&gt;&lt;/p&gt;
&lt;p&gt;If you haven't already done so (via the &lt;strong&gt;Project -&amp;gt; Properties&lt;/strong&gt; menu), the tool will alert you to change name and name and description for the new layout. Click &lt;em&gt;Yes&lt;/em&gt; on the popup to get to the Properties screen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Layout properties screen" src="static/msklc/9_properties_screen.png" title="Layout properties screen"&gt;&lt;/p&gt;
&lt;p&gt;The important fields here are &lt;strong&gt;Name&lt;/strong&gt; and &lt;strong&gt;Description&lt;/strong&gt;: &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Name&lt;/strong&gt; is a short name that will identify our layout within Windows, and as such may not have special characters or be too long.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Description&lt;/strong&gt; is the name that shows up on the language switcher (see below) - since it shows only a small window you may want to describe your customization at the beginning of the field so that it's easier to identify your layout&lt;/p&gt;
&lt;p&gt;&lt;img alt="Language switcher example" src="static/msklc/10_language_switcher_initial.png" title="Language switcher example"&gt;&lt;/p&gt;
&lt;p&gt;After saving the layout's properties MSKLC will build an installer - by default, it will be located at C:\Users\USER\Documents[layout name]&lt;/p&gt;
&lt;p&gt;&lt;img alt="Built Layout installer" src="static/msklc/11_layout_built_files.png" title="Built layout installer"&gt;&lt;/p&gt;
&lt;p&gt;If you want to share the created layout between computers (say, in a corporate setting perhaps), just copy the contents of this folder and run the installer. &lt;/p&gt;
&lt;p&gt;To install the layout to the current machine, simply run the setup.exe executable and reboot the machine&lt;sup id="fnref:3"&gt;&lt;a class="footnote-ref" href="#fn:3"&gt;3&lt;/a&gt;&lt;/sup&gt; to have it available.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Windows language switcher" src="static/msklc/12_windows_language_switcher_final.png" title="Windows language switcher"&gt;&lt;/p&gt;
&lt;p&gt;Windows language switcher after installing the new layout&lt;/p&gt;
&lt;h2&gt;3 - Extra - Dead keys&lt;/h2&gt;
&lt;p&gt;Since Swedish only has one letter with an uncommon diacritic above it, we could get by simply mapping the pair of lowercase/uppercase letters to a modifier+key combination. If we had to add a diacritic that might affect multiple letters, MSKLC provides the option to create a &lt;a href="https://en.wikipedia.org/wiki/Dead_key"&gt;Dead key&lt;/a&gt; which is a letter used to attach a diacritic to a base letter (in the brazilian ABNT layouts, for example, &lt;strong&gt;´/`&lt;/strong&gt;, &lt;strong&gt;~/^&lt;/strong&gt; and &lt;strong&gt;¨&lt;/strong&gt; are dead keys). 
For those not used to the concept, creating a dead key for '°' means we'd be able to create å/Å by typing the combination for '°' and then the letter a/A.&lt;/p&gt;
&lt;p&gt;To add ° as a diacritic mapped by AltGr+e (which maps to the '°' symbol on a portuguese keyboard layout), for example:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Load the keyboard layout and select the key to map in the same way as we've done before. Click 'All...' on the popup instead of 'OK' to bring up the full options for the key:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="Dead key start" src="static/msklc/13_dead_key_1_start.png" title="Dead key start"&gt;&lt;/p&gt;
&lt;p&gt;On the full options panel, toggle the 'Dead Key View' and then toggle 'Dead Key?' for the desired shift states (in our case, ctrl+alt+&lt;key&gt;, which amounts to AltGr+&lt;key&gt;) to enable further options.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Full options popup" src="static/msklc/14_dead_key_2_full_options_start.png" title="Full options popup"&gt;
Click on the '...' button that was just enable to open the dead key definition table.&lt;/p&gt;
&lt;p&gt;For each composite character we want to enable, we'll need to write the base character (in our case, 'a' or 'A') on the 'Base (code point) column' and the composite character (å or Å) on the 'Composite (code point)' column.&lt;/p&gt;
&lt;p&gt;After filling lines for both å and Å, we should have a table filled like this.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Filled dead key table" src="static/msklc/15_filled_dead_key_table.png" title="Filled deadkey table"&gt;&lt;/p&gt;
&lt;p&gt;Click OK on the table popup, OK again on the previous key edition popup, and we're done! Now all we would need to do is to build the layout installer and install the keyboard layout as we did before.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;In no particular order, they include having fiinished my last package of &lt;a href=""&gt;liquorice&lt;/a&gt;, visiting friends who moved to Sweden, being curious about trying out surströmming, and being able to understand a larger part of the jokes on the &lt;a href=""&gt;SSSS&lt;/a&gt; comment section&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;I don't have the link to that particular tweet, but it's the right combination of Windows Management and random IT stuff to make me believe it was an answer in a &lt;a href="https://twitter.com/SwiftOnSecurity"&gt;SwiftOnSecurity&lt;/a&gt; thread, so go follow Tay if you haven't yet.&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:3"&gt;
&lt;p&gt;It's a windows tool being used to install a windows feature, we'd &lt;em&gt;obviously&lt;/em&gt; never be able to get to the end of the instructions without at least one reboot.&amp;#160;&lt;a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="misc"></category></entry><entry><title>Questões perguntadas por alguém sobre HTTPS</title><link href="https://victal.eti.br/questoes-perguntadas-por-alguem-sobre-https.html" rel="alternate"></link><published>2019-09-27T00:00:00-03:00</published><updated>2019-09-27T00:00:00-03:00</updated><author><name>victal</name></author><id>tag:victal.eti.br,2019-09-27:/questoes-perguntadas-por-alguem-sobre-https.html</id><summary type="html">&lt;p&gt;No primeiro texto falando sobre HTTPS publicado aqui há uns tempos, foi feita uma introdução ao funcionamento do protocolo HTTPS, principalmente sobre os comos e porquês teóricos de utilizá-lo sempre que possível - esse texto pode ser encontrado &lt;a href="https://victal.eti.br/qustoes-perguntadas-por-ninguem-sobre-https.html"&gt;aqui&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Se no primeiro texto utilizamos questões hipotéticas como artifício literário para facilitar …&lt;/p&gt;</summary><content type="html">&lt;p&gt;No primeiro texto falando sobre HTTPS publicado aqui há uns tempos, foi feita uma introdução ao funcionamento do protocolo HTTPS, principalmente sobre os comos e porquês teóricos de utilizá-lo sempre que possível - esse texto pode ser encontrado &lt;a href="https://victal.eti.br/qustoes-perguntadas-por-ninguem-sobre-https.html"&gt;aqui&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Se no primeiro texto utilizamos questões hipotéticas como artifício literário para facilitar a leitura, neste o intuito é responder algumas questões reais que ficaram abertas no texto anterior e/ou foram feitas por ou para mim apõs a publicação anterior, antes de entrar em maiores detalhes/mudar de assunto.&lt;/p&gt;
&lt;h2&gt;1 - SSL? TLS? SSL/TLS? O que é o quê entre os dois protocolos?&lt;/h2&gt;
&lt;p&gt;Enquanto a definição de HTTPS (um protocolo em que uma camada de criptografia é adicionada em volta da comunicação via protocolo HTTP), SSL e TLS costumam causar mais confusão, principalmente por serem usados de forma intercambiável para definir "o protocolo utilizado para criptografar os dados numa conexão HTTPS".&lt;/p&gt;
&lt;p&gt;De forma estrita, &lt;em&gt;SSL&lt;/em&gt; (Secure Sockets Layer), é o protocolo inicial desenvolvido pela Netscape para atuar como esta camada de criptografia em cima do protocolo HTTP. Este SSL 'estrito' é um protocolo já obsoleto, tendo sua última versão (3.0) definida em 1996 e devendo ser utilizado apenas quando for absolutamente necessário permitir o acesso de clientes que suportem apenas este protocolo.&lt;/p&gt;
&lt;p&gt;Em 1999, uma versão atualizada do protocolo SSL 3.0 foi proposta pela Internet Engineering Task Force. Para identificar que esta versão do protocolo e as subsequentes estariam sob desenvolvimento e tutela da IETF e não mais da Netscape, o protocolo em proposta foi renomeado para &lt;em&gt;TLS&lt;/em&gt; (Transport Layer Security) 1.0.&lt;/p&gt;
&lt;p&gt;Por conta desta continuidade, é comum e inócuo se referir de forma intercambiável a SSL ou TLS (ou SSL/TLS) em discussões/textos em que não é necessário especificar a versão do protocolo utilizada. &lt;/p&gt;
&lt;p&gt;Para discussões em que a versão exata do protocolo é relevante, como definição de quais versões de protocolo suportar em um determinado servidor, ou quais protocolos estão vulneráveis a uma determinada vulnerabilidade, é imperativo explicitar o protocolo e a(s) versão(ões) em discussão.&lt;/p&gt;
&lt;p&gt;Por simplicidade e para deixar clara a obsolescência do protocolo SSL, será utilizado o nome TLS neste texto mesmo quando se tratar de uma situação em que ambos os protocolos seriam válidos.&lt;/p&gt;
&lt;h2&gt;2 - Que subdomínios estão cobertos por um certificado 'wildcard'? Tenho um nome de domínio com N níveis de sub-(sub-sub-sub-sub-)subdomínios, consigo gerar um certificado único que funcione neste caso?&lt;/h2&gt;
&lt;p&gt;Relembrando do texto anterior, certificados &lt;em&gt;wildcard&lt;/em&gt; são válidos para todos os subdomínios de um determinado domínio. Por exemplo, um certificado &lt;em&gt;wildcard&lt;/em&gt; para &lt;strong&gt;*.victal.eti.br&lt;/strong&gt; é válido para qualquer &lt;strong&gt;subdominio.victal.eti.br&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;O 'asterisco' num certificado wildcard, porém, é valido apenas como &lt;em&gt;prefixo&lt;/em&gt; de um domínio e substitui apenas &lt;em&gt;um nível&lt;/em&gt; de subdomínios. Ou seja:
 - Um certificado para &lt;strong&gt;*.example.org&lt;/strong&gt; NÃO é válido para o endereço sub1.sub2.example.org - é necessário um certificado válido especificamente para este domínio ou um wildcard para &lt;strong&gt;*.sub2.example.org&lt;/strong&gt;
 - Um "domínio" *.*.example.org não é válido em um certificado - é necessário que o certificado se refira a cada subdomínio intermediário (*.sub1.example.org, *.sub2.example.org, etc.) explicitamente
 - Um certificado wildcard por si só &lt;strong&gt;NÃO&lt;/strong&gt; é válido para a raiz do domínio, e.g. o certificado para *.example.org &lt;em&gt;nâo vale&lt;/em&gt; para https://example.org (sem qualquer subdomínio). Nesse caso deve ser utilizado um certificado válido explicitamente para o domínio raiz e para os subdomínios, como no caso abaixo, do DuckDuckGo:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Certificado para duckduckgo.com" src="static/cert_duckduckgo.png" title="Certificado para duckduckgo.com"&gt;&lt;/p&gt;
&lt;h2&gt;3 - Quais as diferenças entre os tipos de validação de certificados existentes? Quando vale a pena o custo de obter um certificado com validação mais completa?&lt;/h2&gt;
&lt;p&gt;Para uso em comunicação via HTTPS, Autoridades Certificadoras comumente fornecem certificados com um entre três diferentes níveis de validação. Embora todos ofereçam o mesmo tipo de segurança quanto à integridade e confidencialidade dos dados trafegados, alguns oferecem validações extras no que diz respeito à autenticidade do serviço disponibilizado, a saber:&lt;/p&gt;
&lt;p&gt;Domain Validation (DV) - Este é o tipo de validação mais comum, que consiste apenas em validar que o solicitante do certificado mantém algum tipo de controle sobre o nome DNS do domínio para o qual o certificado será gerado, exigindo por exemplo:
  - a criação de uma entrada DNS do tipo TXT para o domínio 
  - a disponibilização de um arquivo em um servidor Web acessível por esse nome&lt;/p&gt;
&lt;p&gt;Por conta do tipo de validação realizado, um certificado DV é capaz de autenticar apenas que corresponde ao nome de domínio que está sendo acessado.&lt;/p&gt;
&lt;p&gt;Organization Validation (OV) - Além do domínio para o qual o certificado é válido, um certificado OV é associado também a uma Organização (e.g. uma empresa ou órgão governamental), cujos dados são adicionados ao certificado e são portanto validados pela Autoridade Certificadora por meios "externos" à solicitação, por exemplo:
  - Dados de cadastro da Organização no órgão governamental competente
  - Dados de cadastro da Organização em uma base de dados de um órgão terceiro considerado confiável (e.g. Serviços de registro de empresas como a &lt;a href="https://www.dnb.com/duns-number.html"&gt;Dun &amp;amp; Breadstreet&lt;/a&gt;)
  - Solicitação de documentos recentes da Organização (e.g. contas ou documentos fornecidos por um banco ou órgão público) para comprovar os dados de nome e endereo da Organização&lt;/p&gt;
&lt;p&gt;Com um certificado deste tipo, embora um browser acessando o endereço correspondente não demonstre imediatamente que o certificado, e por tabela, o site, está associado a uma determinada organização, é possível verificar esta associação acessando os detalhes do certificado no browser. Por exemplo, para o site do &lt;a href="https://www.bb.com.br"&gt;Banco do Brasil&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Acesso ao site do BB" src="static/https/2/bb_site.png" title="Acesso ao site do BB"&gt;&lt;/p&gt;
&lt;p&gt;Acessando o site, não há nenhuma diferença visível imediatamente.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Certificado para www.bb.com.br" src="static/https/2/bb_cert.png" title="Certificado para www.bb.com.br"&gt;&lt;/p&gt;
&lt;p&gt;Consultando os detalhes do certificado podemos verificar que o mesmo está associado à organização "Banco do Brasil S.A."&lt;/p&gt;
&lt;p&gt;Para mais detalhes sobre quais validações a serem feitas na emissão de certificados DV e OV, pode-se consultar os &lt;a href="https://cabforum.org/baseline-requirements-documents/"&gt;Baseline Requirements&lt;/a&gt; do CA/Browser Forum - um consórcio formado por Autoridades Certificadoras e outras partes interessadas a fim de definir e divulgar práticas aceitas para a emissão de certificados TLS.&lt;/p&gt;
&lt;p&gt;Extended Validation (EV) - Assim como os certificados OV, estes também são associados a uma Organização, porém para emissão destes a Autoridade Certificadora deve realizar uma série de validações muito mais estrita tanto nos dados solicitados quanto na forma de verificação, incluindo:
 - Verificação de que a organização está registrada e operando (por um determinado período mínimo de tempo) sob o nome a ser adicionado ao certificado
 - Verificação da identidade de um indivíduo responsável pela organização perante a AC
 - Verificação de uma forma de contato &lt;em&gt;out of band&lt;/em&gt; com a organização.&lt;/p&gt;
&lt;p&gt;A existência de uma validação mais estrita costuma fazer com que certificados EV sejam significativamente mais caros e mais demorados de se obter. A contrapartida porém é que diferentemente dos certificados DV e OV, um certificado EV pode ser considerado como prova de que o serviço a que se tem acesso está de fato associado a uma determinada organização.
y
Por este motivo, é comum que em versões mais antigas de browsers sites com certificados EV tenham o nome da organização a que pertencem apresentado ao lado da URL (como abaixo, no site da Symantec acessado pelo Firefox ESR)&lt;/p&gt;
&lt;p&gt;&lt;img alt="Site com certificado EV no Firefox ESR" src="static/https/2/symantec_site.png" title="Site com certificado EV"&gt;&lt;/p&gt;
&lt;h2&gt;3.5 - OK, entendi o que significam os diferentes tipos de certificados. Mas qual eu devo usar no meu site?&lt;/h2&gt;
&lt;p&gt;Apesar da longa descrição acima, no frigir dos ovos atualmente a sugestão para qualquer novo serviço é simplesmente &lt;strong&gt;utilizar um certificado DV&lt;/strong&gt;, utilizando uma AC que forneça certificados gratuitos como a Let's Encrypt se estiver disponível para seu caso de uso, e, preferencialmente, de forma que seja possível automatizar a renovação dos certificados. Como descrito anteriormente, para fins de integridade e confidencialidade dos dados trafegados, o tipo de validação do certificado utilizado é indiferente.&lt;/p&gt;
&lt;p&gt;Quanto às garantias de autenticidade para os diferentes tipos de validação, algumas questões fazem com que, no mínimo, os pontos positivos dos certificados OV ou EV usualmente não compensem os custos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Os indicadores visuais de certificados EV (como o mostrado na seção anterior) estão sendo sistematicamente removidos dos principais browsers em termos de fatia de mercado (Chrome, Firefox e Safari por exemplo) após pesquisas A/B indicarem que a presença ou ausência destes não leva a diferenças no comportamento por parte dos usuários.&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2"&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;Mesmo em browsers em que o indicador visual ainda está presente, como o conteúdo do mesmo é controlado por quem solicita o certificado, é relativamente simples gerar certificados cujo nome colida com outra entidade para fins de &lt;em&gt;phishing&lt;/em&gt; e &lt;em&gt;spoofing&lt;/em&gt;, bastando fazê-lo em uma jurisdição diferente da organização alvo do &lt;em&gt;spoof&lt;/em&gt;. &lt;sup id="fnref:3"&gt;&lt;a class="footnote-ref" href="#fn:3"&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;Devido às restrições de validação, não é possível gerar certificados &lt;em&gt;wildcard&lt;/em&gt; com validação EV. Certificados para múltiplos subdomínios precisam listar explicitamente todos os domínios desejados (o que impede seu uso para alguns casos de uso, como subdomínios definidos por usuários) e normalmente têm um custo muito mais elevado que certificados para um único domínio.&lt;/li&gt;
&lt;li&gt;O custo de um certificado EV é elevado, tanto em relação ao valor monetário (na escala de centenas de dólares para um certificado com validade de no máximo dois anos), quanto na burocracia para obtenção e renovação do certificado, que exige que o processo de renovação seja planejado antecipadamente e impede sua automatização completa.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Assim, recomenda-se a obtenção de certificados EV apenas para casos de uso que obriguem sua utilização - como para assinatura de arquivos executáveis (algo completamente não relacionado a HTTPS, mas que também depende de certificados TLS) ou caso algum órgão regulador exija o uso de certificados OV/EV para sites de determinadas organizações (embora deva salientar que não conheça casos concretos do gênero) - para todos os outros casos, &lt;strong&gt;basta um certificado DV&lt;/strong&gt;, idealmente com um renovação automática.&lt;/p&gt;
&lt;h2&gt;4 - Aonde consigo mais informações sobre esses assuntos?&lt;/h2&gt;
&lt;p&gt;Além dos links ao longo do texto, as páginas abaixo oferecem mais conteúdo relevante e aprofundado sobre o funcionamento de certificados TLS, as diferenças entre cada tipo de certificado e outros assuntos referentes ao uso/implementação de HTTPS. Infelizmente, a maioria está em inglês:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://cabforum.org"&gt;CA/Browser Forum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.cloudflare.com/learning/ssl/what-is-https/"&gt;Cloudflare Learning&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.bleepingcomputer.com/news/security/extended-validation-ev-certificates-abused-to-create-insanely-believable-phishing-sites/"&gt;Phishing utilizando Certificados EV&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.troyhunt.com/extended-validation-certificates-are-dead/"&gt;Extended Validation Certificates are Dead&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.troyhunt.com/extended-validation-certificates-are-really-really-dead/"&gt;Extended Validation Certificates are (Really, Really) Dead&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;&lt;a href="https://groups.google.com/a/chromium.org/forum/m/#!msg/security-dev/h1bTcoTpfeI/jUTk1z7VAAAJ"&gt;Link&lt;/a&gt; para o aviso da remoção de indicador de certificado EV da UI do google chrome&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;&lt;a href="https://groups.google.com/forum/m/?fromgroups&amp;amp;hl=en#!topic/firefox-dev/6wAg_PpnlY4"&gt;Link&lt;/a&gt; para o aviso da remoção de indicador de certificado EV da UI do Firefox&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:3"&gt;
&lt;p&gt;Por exemplo, o caso de spoofing do Stripe descrito em "&lt;a href="https://arstechnica.com/information-technology/2017/12/nope-this-isnt-the-https-validated-stripe-website-you-think-it-is/"&gt;Nope, this isn’t the HTTPS-validated Stripe website you think it is&lt;/a&gt;"&amp;#160;&lt;a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="https"></category></entry><entry><title>Questões perguntadas por ninguém sobre HTTPS</title><link href="https://victal.eti.br/questoes-perguntadas-por-ninguem-sobre-https.html" rel="alternate"></link><published>2019-09-27T00:00:00-03:00</published><updated>2019-09-27T00:00:00-03:00</updated><author><name>victal</name></author><id>tag:victal.eti.br,2019-09-27:/questoes-perguntadas-por-ninguem-sobre-https.html</id><summary type="html">&lt;p&gt;Este texto é o primeiro de uma série tentativa de tópicos relacionados à segurança - inicialmente no desenvolvimento e manutenção de aplicações web - a fim de consolidar os conhecimentos adquiridos na área ao longo de alguns anos de estudo e desenvolvimento de aplicações deste tipo.&lt;/p&gt;
&lt;p&gt;Iniciamos por algumas questões sobre HTTPS …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Este texto é o primeiro de uma série tentativa de tópicos relacionados à segurança - inicialmente no desenvolvimento e manutenção de aplicações web - a fim de consolidar os conhecimentos adquiridos na área ao longo de alguns anos de estudo e desenvolvimento de aplicações deste tipo.&lt;/p&gt;
&lt;p&gt;Iniciamos por algumas questões sobre HTTPS que, devido ao quão ubíquo o uso (e a recomendação de uso) de HTTPS em detrimento do HTTP se tornou, usualmente são relevadas durante as discussões sobre o assunto.&lt;/p&gt;
&lt;p&gt;Com alguma sorte, este texto deveria ser útil também para outros procurando informações em português&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt; sobre o assunto - porém alguns links e referências ao longo do texto poderão estar em inglês.&lt;/p&gt;
&lt;p&gt;O artigo está estruturado com base no &lt;a href="https://pt.wikipedia.org/wiki/5WH"&gt;5W1H&lt;/a&gt;, uma forma de listar perguntas a serem feitas para compreender um fato, história ou situação (Who?/What?/Where?/When?/Why?/How? em inglês, ou Quem?/Quê?/Quando?/Onde?/Por quê?/Como? em português), a fim de apresentar os comos e porquês do uso de HTTPS.&lt;/p&gt;
&lt;h2&gt;1 - O que é HTTPS?&lt;/h2&gt;
&lt;p&gt;HTTPS é a sigla para Hyper Text Transfer Protocol, Secure - um protocolo que envelopa a comunicação via HTTP de forma criptografada utilizando um protocolo TLS ou SSL, com um certificado apresentado pelo servidor HTTPS ao qual se está conectando. 
(Por completeza: HTTP é o protocolo padrão utilizado para transferência de dados na Web - entre um browser e o servidor que hospeda um site&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2"&gt;2&lt;/a&gt;&lt;/sup&gt; ou entre aplicações e APIs na Web ou mesmo em redes internas).&lt;/p&gt;
&lt;p&gt;Embora mais detalhes sobre como esta criptografia é realizada serão apresentados em outro momento, esta descrição basta para apresentar as motivações para utilizar HTTPS na comunicação entre um cliente e um servidor (em oposição a simplesmente utilizar HTTP), e como e quando fazer isso.&lt;/p&gt;
&lt;h2&gt;2 - Por que utilizar HTTPS?&lt;/h2&gt;
&lt;p&gt;Resumidamente, o uso do protocolo HTTPS na comunicação cliente-servidor garante três objetivos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Autenticidade: Durante o estabelecimento da conexão HTTPS, o servidor apresenta um certificado, que é atrelado a um ou mais nomes de domínio específicos. Com isso, uma vez que o cliente (vulgo browser) verifica que o certificado apresentado por um servidor para um domínio é válido, verifica por tabela que o servidor a que está se conectando é o autêntico responsável por servir o conteúdo referente àquele domínio.&lt;/li&gt;
&lt;li&gt;Integridade: Dado que o certificado apresentado pelo servidor é autêntico, não deveria ser possível&lt;sup id="fnref:3"&gt;&lt;a class="footnote-ref" href="#fn:3"&gt;3&lt;/a&gt;&lt;/sup&gt; a um terceiro alterar o conteúdo da comunicação entre o cliente e o servidor de forma indetectável por estes.&lt;/li&gt;
&lt;li&gt;Confidencialidade: Dado que o certificado apresentado pelo servidor é autêntico, não deveria ser possível a um terceiro ler o conteúdo não criptografado da comunicação entre estes.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note-se que esses objetivos são alcançados supondo que o cliente consiga validar que o tal certificado apresentado pelo servidor é válido e autêntico, o que leva à próxima questão:&lt;/p&gt;
&lt;h2&gt;3 - Quem vai saber dizer se um certificado é autêntico?&lt;/h2&gt;
&lt;p&gt;A validação de um certificado pelo browser pode ocorrer de duas formas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Adicionando (ou "instalando") diretamente o certificado a um rol de certificados "confiáveis" do cliente. Isto pode ser feito com o certificado sendo transmitido ao cliente previamente por uma via segura que não a conexão HTTPS com o servidor, e é mais comum para servidores que fazem parte de uma rede interna (p.ex. em uma empresa), na qual a quantidade de clientes que vão acessar o servidor, e portanto precisam receber e instalar o certificado, é limitada.&lt;/li&gt;
&lt;li&gt;Confiando em um certificado-raiz: Um certificado TLS atrelado a um domínio é normalmente emitido por uma entidade denominada Autoridade Certificadora (CA na sigla em inglês) - que verifica que o certificado para um determinado domínio foi solicitado por um responsável por este. O certificado gerado é assinado pela CA utilizando o certificado &lt;em&gt;dela&lt;/em&gt;, que por sua vez foi gerado e assinado como sendo válido por uma outra CA, e assim por diante até chegar em uma entre um número de CAs "raiz", cujos certificados são validados por meios externos a essa árvore de CAs por fabricantes de software, que por sua vez adicionam estes certificados raiz como confiáveis pelos seus browsers/SOs/outros clientes.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Por exemplo, o certificado para https://www.bb.com.br tem uma cadeia com três certificados, em que o certificado para "USERTrust RSA Certification Authority" corresponde ao certificado raiz.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Hierarquia de certificados para www.bb.com.br" src="static/hierarquia_certificados.png" title="Hierarquia de certificados para www.bb.com.br"&gt;&lt;/p&gt;
&lt;p&gt;Vale explicitar também que a validação descrita acima diz respeito apenas à validação da &lt;em&gt;autenticidade&lt;/em&gt; do certificado, mas o cliente usualmente valida outras informações do mesmo, como:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;Data de Validade&lt;/em&gt;: Os certificados utilizados tem um tempo de vida que variam entre alguns meses e um a dois anos. Via de regra, para evitar problemas em caso de vazamento de dados privados referentes ao certificado, é sugerido o uso de certificados com tempo de vida mais curto aliados a formas de facilitar ou automatizar sua substituição.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;Domínio&lt;/em&gt;: Certificados são atrelados a um domínio (e.g. victal.eti.br) e um ou mais subdomínios do mesmo, de forma que (por definição) é necessário que o cliente verifique que o domínio para o qual o certificado é válido é o mesmo que está sendo acessado.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Também é possível, juntando estas duas formas de validação, adicionar diretamente um certificado não verificado através da hierarquia normal de certificados-raiz à lista de certificados confiáveis a fim de confiar nos certificados geraos e assinados a partir dele. Isto é algo mais plausível em redes internas corporativas com um número significativo de serviços web - por ser mais simples adicionar um certificado raiz às máquinas dos colaboradores conectadas à rede do que os certificados para todos os serviços disponíveis (certificados que teriam que ser re-adicionados periodicamente conforme os anteriores expirassem).&lt;/p&gt;
&lt;h2&gt;4 - Onde e quando usar HTTPS?&lt;/h2&gt;
&lt;p&gt;Sempre (que possível). &lt;/p&gt;
&lt;p&gt;Com o advento de certificados TLS gratuitos em massa (via &lt;a href="https://letsencrypt.org/"&gt;Let's Encrypt&lt;/a&gt; e outros CAs), &lt;a href="https://www.httpvshttps.com"&gt;melhorias de performance significativas&lt;/a&gt; e mesmo engines de busca dando prioridade a resultados em HTTPS a páginas em HTTP, além dos ganhos de segurança, não deveria haver motivo para deixar de utilizar HTTPS em todo servidor Web acessível na Internet.&lt;/p&gt;
&lt;p&gt;Em casos que o servidor lida com dados sensíveis (como logins/senhas ou outros dados de autenticação, ou dados acessíveis apenas a usuários cadastrados/administrativos), é imediato chegar à conclusão de que se precisa utilizar HTTPS por conta da confidencialidade dos dados.&lt;/p&gt;
&lt;p&gt;Para serviços (ou partes de um serviço) que não lidam com este tipo de dado porém, ainda é relevante o uso de HTTPS pelas suas características de Autenticidade e Integridade de dados. Conexões HTTP são trivialmente suscetíveis a ataques de MITM[^4], em que um terceiro sistema altera o conteúdo das mensagens trafegadas entre o cliente e o servidor para, por exemplo:
  - Substituir arquivos para download inócuos por versões com malware;
  - Adicionar scripts para injeção de conteúdo que podem ir de simples propagandas (algo que até provedores de internet chegam a fazer) a mineradores de criptomoeda ou ataques de CSRF a outras páginas (como a &lt;a href="https://nakedsecurity.sophos.com/2012/10/01/hacked-routers-brazil-vb2012/"&gt;interface de administração do seu roteador&lt;/a&gt;).&lt;/p&gt;
&lt;h2&gt;5 - Como usar HTTPS para servir conteúdo?&lt;/h2&gt;
&lt;p&gt;Agora que nos convencemos(?) de que é necessário utilizar HTTPS quando disponibilizando conteúdo na Web, vejamos como fazê-lo. Neste caso, o certificado será gerado via Let's Encrypt, e instalado em um servidor Apache 2 ao qual se tem acesso remoto. Para configuração em outras situações (como um serviço de hospedagem que fornece apenas uma interface de admin via Web, por exemplo), pode ser necessário consultar a documentação do serviço de administração ou hosting para realizar a instalação do certificado.&lt;/p&gt;
&lt;h3&gt;5.1 - Geração de certificados&lt;/h3&gt;
&lt;p&gt;Para geração do certificado, o Let's Encrypt disponibiliza o &lt;a href="https://certbot.eff.org"&gt;Certbot&lt;/a&gt;, uma ferramenta de linha de comando para geração de certificados TLS e, em alguns casos, configuração automática do servidor Web. &lt;/p&gt;
&lt;p&gt;Instruções de instalação e uso do Certbot específicas por sistema operacional e Servidor Web podem ser encontradas &lt;a href="https://certbot.eff.org/instructions"&gt;aqui&lt;/a&gt; (em inglês) - e caso a combinação de SO e Web server utilizados se encaixe em uma das configurações apresentadas no site, recomenda-se utilizá-la, para obter funcionalidades extras como atualização automática do certbot ou renovação automática de certificados.&lt;/p&gt;
&lt;p&gt;Caso não seja possível seguir as instruções descritas na documentação oficial, os passos a seguir deveriam ser o suficiente para gerar um par de certificados para os domínios desejados - o único pré-requisito é uma máquina com Linux instalado para a execução do certbot.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Baixe a última versão do certbot-auto, um wrapper para o certbot que trata da instalação/atualização da ferramenta propriamente dita, copie-a para uma pasta que faça parte do &lt;code&gt;$PATH&lt;/code&gt; (por conveniência), torne executável com &lt;code&gt;chmod&lt;/code&gt; e execute-a sem argumentos para realizar o processo de instalação.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;    wget https://dl.eff.org/certbot-auto&lt;/span&gt;
&lt;span class="err"&gt;    sudo mv certbot-auto /usr/local/bin/certbot-auto&lt;/span&gt;
&lt;span class="err"&gt;    sudo chown root /usr/local/bin/certbot-auto&lt;/span&gt;
&lt;span class="err"&gt;    sudo chmod 0755 /usr/local/bin/certbot-auto&lt;/span&gt;
&lt;span class="err"&gt;    certbot-auto&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para validar que o requisitante do certificado é responsável pelo respectivo domínio, o Certbot utiliza uma de duas verificações possíveis, à escolha do usuário:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DNS: Em que é solicitado ao requisitante adicionar um registro DNS do tipo TXT para um subdomínio específico do domínio solicitado, com um valor gerado dinamicamente;&lt;/li&gt;
&lt;li&gt;HTTP: Em que é solicitada ao requisitante a inclusão de um conteúdo gerado dinamicamente em um path também dinamicamente gerado (iniciando em /.well-known/acme-challenge) no servidor Web acessível através do nome de domínio para o qual o certificado está sendo gerado.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Restrições na forma de validação ocorrem apenas para certificados &lt;em&gt;wildcard&lt;/em&gt;, válidos para todos os subdomínios de um domínio (e.g. o certificado &lt;em&gt;wildcard&lt;/em&gt; para &lt;code&gt;*.example.org&lt;/code&gt; vale para todo subdomínio qualquercoisa.example.org). Como não é possível listar todos os subdomínios válidos de um domínio a fim de validá-los via HTTP, a validação deve ser feita via DNS.&lt;/p&gt;
&lt;p&gt;Desta forma, para solicitar a geração de certificados para um ou mais domínios, basta executar:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;certbot&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;certonly&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--manual -d [domínio] [-d um-subdomínio -d outro-subdomínio etc.] --preferred-challenges [dns ou http]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;e seguir os passos no terminal.&lt;/p&gt;
&lt;p&gt;Por exemplo, para gerar um certificado para os domínios 'victal.eti.br' e 'www.victal.eti.br' (i.e. para este site), temos a seguinte série de passos: &lt;/p&gt;
&lt;p&gt;1 - Inicialmente, é requisitado um email para contato (em caso de algum problema que gere a invalidação do certificado ou quando o mesmo estiver para expirar):&lt;/p&gt;
&lt;p&gt;&lt;img alt="Execução do certbot para um domínio" src="static/certbot-1-email.png" title="Execução do certbot para um domínio"&gt;&lt;/p&gt;
&lt;p&gt;2 - Em seguida, é solicitado o aceite dos termos de serviço do Let's encrypt (disponíveis em https://letsencrypt.org/documents/LE-SA-v1.2-November-15-2017.pdf), do compartilhamento (opcional) do e-mail adicionado anteriormente com a &lt;a href="https://eff.org"&gt;EFF&lt;/a&gt;, entidade criadora e das principais mantenedoras do Let's Encrypt, e do consentimento ao armazenamento do endereço IP utilizado para geração do certificado (obrigatório).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Aceite de termos de uso" src="static/certbot-2-checks.png" title="Aceite de termos de uso"&gt;&lt;/p&gt;
&lt;p&gt;3 - Nesse ponto é fornecido o valor a ser utilizado na entrada DNS com tipo TXT para validação do domínio. A entrada deve ser criada para o hostname &lt;code&gt;_acme-challenge.[domínio sendo validado]&lt;/code&gt;. Este passo se repete para cada subdomínio passado como parâmetro para o certbot.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Validação via DNS" src="static/certbot-3-challenge.png" title="Validação via DNS"&gt;&lt;/p&gt;
&lt;p&gt;3.5 - Pode-se validar a configuração DNS realizada com &lt;code&gt;dig TXT _acme-challenge.[domínio]&lt;/code&gt; ou outra ferramenta de consulta DNS&lt;/p&gt;
&lt;p&gt;&lt;img alt="Teste de configuração DNS" src="static/certbot-4-dig.png" title="Teste de configuração DNS"&gt;&lt;/p&gt;
&lt;p&gt;4 - Caso a verificação tenha ocorrido com sucesso, os certificados terão sido criados &lt;code&gt;/etc/letsencrypt/live/[domínio]&lt;/code&gt; (na prática, com symlinks para &lt;code&gt;/etc/letsencrypt/archive&lt;/code&gt;). 
Na imagem, os sufixos nos nomes dos arquivos ocorrem por estar re-gerando certificados para o mesmo domínio, que já haviam sido renovados algumas vezes (o certbot guarda o histórico de certificados gerados).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Certificados gerados" src="static/certbot-5-certs.png" title="Certificados gerados"&gt;&lt;/p&gt;
&lt;h3&gt;5.2 - Configuração do Servidor Web&lt;/h3&gt;
&lt;p&gt;Após a obtenção dos certificados, a configuração do Servidor Web para utilizá-los é, como se pode esperar, bastante dependente do servidor utilizado (Apache, nginx, IIS ou qualquer outro). &lt;/p&gt;
&lt;p&gt;Configurações diferentes são recomendadas dependendo dos clientes que vão se conectar ao servidor. Por exemplo, quando se deseja suportar clientes mais obsoletos como IE 8 ou apps em versões antigas de Android e iOS, são necessárias configurações com maior compatibilidade; e, em contrapartida, caso se deseje suportar apenas as últimas versões de browsers e SOs é possível utilizar configurações mais restritivas mas mais seguras).&lt;/p&gt;
&lt;p&gt;Felizmente, para uma configuração mais rápida do servidor Web desejado pode-se recorrer ao &lt;a href="https://ssl-config.mozilla.org/#server=apache&amp;amp;server-version=2.4.39&amp;amp;config=intermediate&amp;amp;ocsp=false"&gt;Gerador de Configuração SSL&lt;/a&gt; da Mozilla, que oferece trechos de configuração para uma série de Servidores Web ou outros serviços, em diferentes graus de compatibilidade.&lt;/p&gt;
&lt;p&gt;Para os servidores Web de uso mais comum (Apache e Nginx), a aplicação dos trechos de configuração fornecidos por essa ferramenta pode ser realizada de forma suficientemente direta (aqui exemplificada com a configuração de um servidor Apache com configuração Intermediária:&lt;/p&gt;
&lt;p&gt;0 - caso os certificados não tenham sido gerados na mesma máquina em que o servidor web se encontra, copie-os para um diretório no servidor (via SSH, SFTP ou outro protocolo seguro desejado) e certifique-se que apenas o usuário do servidor web (e.g. www-data) tem acesso a este diretório. Como no caso do exemplo acima os certificados foram gerados na própria máquina do servidor, será utilizado o diretório &lt;code&gt;/etc/letsencrypt/live/victal.eti.br&lt;/code&gt; nos exemplos:&lt;/p&gt;
&lt;p&gt;1 - Por via das dúvidas, faça um backup do arquivo de configuração atual do Apache (usualmente dentro de &lt;code&gt;sites-available&lt;/code&gt; no diretório de configuração do Apache) via, por exemplo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;cp /etc/apache2/sites-available/000-default.conf{,.backup}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;2 - Partindo da configuração atual do Apache para o site acessível via HTTP, e do trecho de configuração gerado pelo gerador da Mozilla:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Configuração Apache 1" src="static/apache-1-original.png" title="Configuração Apache 1"&gt;&lt;/p&gt;
&lt;p&gt;3 - Mova a configuração atual do virtualhost para o virtualhost &lt;code&gt;*:443&lt;/code&gt; (i.e. utilizando HTTPS) da configuração gerada&lt;/p&gt;
&lt;p&gt;&lt;img alt="Configuração Apache 2" src="static/apache-2-move.png" title="Configuração Apache 2"&gt;&lt;/p&gt;
&lt;p&gt;4 - Substitua o conteúdo da configuração atual pela nova configuração com o trecho adicionado no passo anterior, trocando os valores das diretivas &lt;code&gt;SSLCertificateFile&lt;/code&gt; e &lt;code&gt;SSLCertificateKeyFile&lt;/code&gt; pelos caminhos para os arquivos &lt;code&gt;fullchain.pem&lt;/code&gt; e &lt;code&gt;privkey.pem&lt;/code&gt; do certificado gerado e salve o arquivo&lt;/p&gt;
&lt;p&gt;&lt;img alt="Configuração Apache 3" src="static/apache-3-overwrite.png" title="Configuração Apache 3"&gt;&lt;/p&gt;
&lt;p&gt;5 - No caso do apache, como pode ser visto no princípio do arquivo de configuração, é necessário habilitar alguns módulos, caso já não estejam habilitados, com:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;a2enmod ssl rewrite headers&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;6 - Recarregue o servidor apache para que as configurações tenham efeito:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;service apache2 reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;6 - Como saber se a configuração HTTPS para um domínio está correta?&lt;/h2&gt;
&lt;p&gt;O teste mais simples e direto para verificar se a configuração do servidor Web realizada anteriormente está OK é simplesmente acessar o servidor via HTTPS a partir de um browser e verificar se a) o servidor está acessível corretamente e b) os dados do certificado apresentados pelo browser correspondem ao certificado gerado anteriormente, por exemplo, acessando o endereço deste site no Firefox: &lt;/p&gt;
&lt;p&gt;Indicativo no browser de conexão via HTTPS (com certificado válido): 
&lt;img alt="Conexão via https no browser" src="static/https-browser-screenshot.png" title="Conexão via HTTPS no browser"&gt;&lt;/p&gt;
&lt;p&gt;Clicando em 'More Information' e em 'View Certificate' na janela seguinte, é possível verificar mais alguns dados do certificado:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Informações do certificado no firefox" src="static/cert-info-browser.png" title="Informações do certificado no Firefox"&gt;&lt;/p&gt;
&lt;p&gt;Para validar com mais profundidade a configuração do Servidor Web quanto a HTTPS, uma ferramenta muito útil é o &lt;a href="https://www.ssllabs.com/ssltest/"&gt;Qualys SSL Server Test&lt;/a&gt;. Além de testar o acesso ao servidor, são verificadas informações como tipos de criptografia permitidos na conexão, versões do protocolo TLS e SSL aceitas pelo servidor, suporte a acesso por diferentes browsers e clientes e suscetibilidade a algumas vulnerabilidades de certas versões e implementações dos protocolos SSL, TLS, e HTTPS, como Heartbleed, POODLE, e DROWN (uma explicação rápida destas vulnerabilidades pode ser encontrada &lt;a href="https://www.security.ufrj.br/tutoriais/servidores-que-utilizam-ssl-vulnerabilidades-e-solucoes/"&gt;neste artigo&lt;/a&gt; e nas suas referências).&lt;/p&gt;
&lt;p&gt;A configuração padrão fornecida pela ferramenta de configuração da Mozilla, apresentada anteriormente, com o grau de compatibilidade 'Intermediate' costuma ser o suficiente para obter um grau A ou A+ no teste do Qualys, por exemplo:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Teste do Qualys para victal.eti.br" src="static/qualys-test-ssl.png" title="Teste do Qualys para victal.eti.br"&gt;&lt;/p&gt;
&lt;h2&gt;7 - O que foi isso que eu acabei de ler? E o que fazer agora? (Próximos passos)&lt;/h2&gt;
&lt;p&gt;Um problema recorrente para soluções de segurança ubíquas e padrões de mercado, como o HTTPS, é que a discussão pela sua adoção começa e termina em "Vamos utilizar HTTPS!", gerando um uso por &lt;a href="https://pt.wikipedia.org/wiki/Culto_%C3%A0_carga"&gt;Culto à carga&lt;/a&gt;, que sempre vai gerar problemas quando as circunstâncias em torno dessa solução mudarem (novas vulnerabilidades? novos protocolos? novas formas de criptografia?)
Idealmente, então, este texto deveria ter servido para consolidar estas explicações básicas dos comos e porquês de utilizar HTTPS, e, de quebra, apresentar um roteiro para realizar uma configuração básica de um servidor Web para suportar este protocolo.&lt;/p&gt;
&lt;p&gt;A partir deste conhecimento, algumas rotas se abrem para aprofundar o conhecimento do uso e funcionamento interno do HTTPS:
  - Outras questões comuns na configuração de HTTPS, como:
    - Conteúdo misto (mixed content)
    - Tráfego/configuração de cookies e outros dados de autenticação de forma segura
    - Configuração de acesso HTTPS via CDNs (e.g. CLoudflare) quando não é possível configurá-lo direto no servidor&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Funcionamento mais a fundo do protocolo TLS, como:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Quais as versões atualmente existentes de TLS/SSL, no que diferem e quais (não) utilizar?&lt;/li&gt;
&lt;li&gt;Como o protocolo estabelece uma comunicação segura entre as partes?&lt;/li&gt;
&lt;li&gt;Quais são os parâmetros de configuração deste protocolo (e.g. as diretivas utilizadas para configurar o servidor Web para HTTPS no exemplo anterior), o que representam e no que influenciam?&lt;/li&gt;
&lt;li&gt;Quais as diferenças entre os tipos de certificados SSL existentes?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Extensões ao protocolo HTTPS, como:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HSTS (HTTP Strict Transport Security) &lt;/li&gt;
&lt;li&gt;HPKP (HTTP Public Key Pinning)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A maioria destes assuntos será apresentada em maior ou menor grau nos próximos textos sobre este tema, e, para artigos e explicações bem mais amplos sobre o assunto, recomendam-se as seguintes fontes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.cloudflare.com/learning/ssl/what-is-ssl/"&gt;Cloudflare Learning&lt;/a&gt; (em inglês)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.troyhunt.com/tag/ssl/"&gt;Blog&lt;/a&gt; do Troy Hunt, pesquisador em segurança da informação e criador do &lt;a href="https://haveibeenpwned.com/"&gt;Have I been Pwned?&lt;/a&gt; (em inglês)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://meusiteprecisadehttps.com.br/"&gt;Meu site precisa de HTTPS?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://httpsiseasy.com/"&gt;HTTPS is Easy&lt;/a&gt; (vídeos em inglês com legenda em português)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;Para conteúdos mais completos sobre o assunto em inglês, pode-se consultar as referências na última seção do texto.&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;Ou sítio, para os mais literalmente lusófonos&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:3"&gt;
&lt;p&gt;"possível" não inclui casos/vulnerabilidades em que é possível quebrar a criptografia utilizada na conexão. Estes casos serão discutidos em momento oportuno.&amp;#160;&lt;a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="https"></category></entry><entry><title>Websphere 7 on Ubuntu Linux</title><link href="https://victal.eti.br/websphere-7-on-ubuntu-linux.html" rel="alternate"></link><published>2016-08-29T13:47:50-03:00</published><updated>2016-08-29T13:47:50-03:00</updated><author><name>victal</name></author><id>tag:victal.eti.br,2016-08-29:/websphere-7-on-ubuntu-linux.html</id><summary type="html">&lt;p&gt;Sharing from &lt;a href="http://www.cnblogs.com/BruceLeey/archive/2010/09/18/1830419.html"&gt;this post&lt;/a&gt;, where I found the solution to a stupid problem:&lt;/p&gt;
&lt;p&gt;Recently I had to go through installing IBM Websphere 7.0 on a Ubuntu VM for development purposes. 
Installing Websphere (and other IBM server products) is already a pain in the ass by itself, but it turned …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Sharing from &lt;a href="http://www.cnblogs.com/BruceLeey/archive/2010/09/18/1830419.html"&gt;this post&lt;/a&gt;, where I found the solution to a stupid problem:&lt;/p&gt;
&lt;p&gt;Recently I had to go through installing IBM Websphere 7.0 on a Ubuntu VM for development purposes. 
Installing Websphere (and other IBM server products) is already a pain in the ass by itself, but it turned out even worse as the process of creating a profile in order to start a server was broken with no obvious solution.&lt;/p&gt;
&lt;p&gt;The output for the manageprofiles.sh script was simply:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;INSTCONFFAILED&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;profile&lt;/span&gt; &lt;span class="n"&gt;could&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;  &lt;span class="n"&gt;For&lt;/span&gt; &lt;span class="n"&gt;more&lt;/span&gt; &lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;consult&lt;/span&gt;
&lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="sr"&gt;/opt/IBM/WebSphere/AppServer/logs/manageprofiles/&lt;/span&gt;&lt;span class="n"&gt;AppSrv01_create&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;log&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pouring through the log file (XML by default, really?) one could find the line&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="s s-Atom"&gt;opt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;IBM&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;WebSphere&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;AppServer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="s s-Atom"&gt;profileTemplates&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="s s-Atom"&gt;default&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="s s-Atom"&gt;action&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="s s-Atom"&gt;generateKeysForSingleProfile&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nn"&gt;ant&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="s s-Atom"&gt;:&lt;/span&gt;
&lt;span class="s s-Atom"&gt;wsadmin&lt;/span&gt; &lt;span class="s s-Atom"&gt;task&lt;/span&gt; &lt;span class="s s-Atom"&gt;failed&lt;/span&gt; &lt;span class="s s-Atom"&gt;with&lt;/span&gt; &lt;span class="s s-Atom"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;code&lt;/span&gt; &lt;span class="o"&gt;:-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;However it turns out (as per the link provided in the beggining of the post) that the issue lies in the shell script that calls the ant script. It seems that the script expects to be run with sh or bash, and breaks since in Ubuntu sh is usually symlinked to dash.&lt;/p&gt;
&lt;p&gt;The rather simple solutions to the problem:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Link /bin/sh to bash&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo unlink /bin/sh
sudo ln -s /bin/bash /bin/sh
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;Reconfigure sh via dpkg&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg-reconfigure dash
&lt;/pre&gt;&lt;/div&gt;</content><category term="java"></category><category term="reblog"></category></entry><entry><title>Running DymoLabel 7.x without a Dymo Printer</title><link href="https://victal.eti.br/running-dymolabel-7x-without-a-dymo-printer.html" rel="alternate"></link><published>2016-08-29T13:05:03-03:00</published><updated>2016-08-29T13:05:03-03:00</updated><author><name>victal</name></author><id>tag:victal.eti.br,2016-08-29:/running-dymolabel-7x-without-a-dymo-printer.html</id><summary type="html">&lt;p&gt;Updated from a solution found &lt;a href="http://windycitytech.blogspot.com.br/2013/06/running-dymo-label-without-dymo-printer.html"&gt;here&lt;/a&gt;. Thanks to the original author.&lt;/p&gt;
&lt;p&gt;One of the projects I was working on required us to update an application that created ID cards using Dymo printers in order to support other brands of printers. &lt;/p&gt;
&lt;p&gt;However, Dymo labels are created and printed using a XML …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Updated from a solution found &lt;a href="http://windycitytech.blogspot.com.br/2013/06/running-dymo-label-without-dymo-printer.html"&gt;here&lt;/a&gt;. Thanks to the original author.&lt;/p&gt;
&lt;p&gt;One of the projects I was working on required us to update an application that created ID cards using Dymo printers in order to support other brands of printers. &lt;/p&gt;
&lt;p&gt;However, Dymo labels are created and printed using a XML file with a custom schema, and I couldn't find another program that could open/import it to convert to a saner format.&lt;/p&gt;
&lt;p&gt;To add insult to injury, trying to run DymoLabel (the application Dymo provides to design/create labels) or an application that uses the Dymo API without a printer installed fails with an error like &lt;em&gt;"This program requires a Dymo Printer. "&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Googling around (which saves lives) took me to &lt;a href="http://windycitytech.blogspot.com.br/2013/06/running-dymo-label-without-dymo-printer.html"&gt;this 2013 post&lt;/a&gt; which provides a workaround:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Go to the &lt;a href="https://web.archive.org/web/20120216022217/http://global.dymo.com/enGB/Troubleshooting/LabelWriter_320.html"&gt;Dymo Support&lt;/a&gt; and look for the first error at Troubleshoot &amp;gt; Error Messages. Download and run the provided ASINSTALL.EXE. The URL in the original post does not work anymore, though, so we're relying on the &lt;a href="https://archive.org/web/"&gt;Internet Archive WayBack Machine&lt;/a&gt; snapshot of it.&lt;/li&gt;
&lt;li&gt;Add a fake printer manually through Windows' Devices and Printers.&lt;/li&gt;
&lt;/ol&gt;</content><category term="tips"></category><category term="reblog"></category></entry><entry><title>Deploying Springboot applications on Jboss 7</title><link href="https://victal.eti.br/deploying-springboot-applications-on-jboss-7.html" rel="alternate"></link><published>2016-03-01T00:00:00-03:00</published><updated>2016-03-01T00:00:00-03:00</updated><author><name>victal</name></author><id>tag:victal.eti.br,2016-03-01:/deploying-springboot-applications-on-jboss-7.html</id><summary type="html">&lt;p&gt;Due to client, budget or technology constraints, sometimes we see ourselves having to use older, even obsolete versions of a given software/technology/language. The most recent here was having to use JBoss AS 7 to deploy some Java applications including one developed using &lt;a href="http://projects.spring.io/spring-boot/"&gt;Spring Boot&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;The process to turn …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Due to client, budget or technology constraints, sometimes we see ourselves having to use older, even obsolete versions of a given software/technology/language. The most recent here was having to use JBoss AS 7 to deploy some Java applications including one developed using &lt;a href="http://projects.spring.io/spring-boot/"&gt;Spring Boot&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;The process to turn a Spring Boot application into a deployable war is quite straightforward and well explained in their extensive &lt;a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-create-a-deployable-war-file"&gt;documentation&lt;/a&gt; and it consists of two steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Change your build tool file (pom.xml for us using Maven) to change the project packaging to war;&lt;/li&gt;
&lt;li&gt;Update your main application class to extend &lt;code&gt;SpringBootServletInitializer&lt;/code&gt;;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This does not work out of the box with Jboss 7, and it doesn't give any logs or errors save for the 404s when trying to access the application.&lt;/p&gt;
&lt;p&gt;As it turns out, the problem is that Jboss 7 doesn't work well with the servlet mapping of &lt;code&gt;/&lt;/code&gt; provided by the default spring configuration. The servlet path must be changed to &lt;code&gt;/*&lt;/code&gt; for it to work, which can be done by adding the line &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;server.servlet-path=/*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;to the application.properties file. &lt;/p&gt;</content><category term="java"></category></entry></feed>